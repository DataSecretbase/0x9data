

## 解决方案



| 角色                                       | 场景                    | LBS功能                                    |
| ---------------------------------------- | --------------------- | ---------------------------------------- |
| ![用户](http://p62mg06ye.bkt.clouddn.com/image/lbs/user1.JPG)用户 | 查询电梯的维保信息，填写地址并发送维保需求 | ![定位](http://p62mg06ye.bkt.clouddn.com/image/lbs/location.png)定位 ![数据](http://p62mg06ye.bkt.clouddn.com/image/lbs/data.png)数据![地图](http://p62mg06ye.bkt.clouddn.com/image/lbs/map.png)地图 |
| ![管理者](http://p62mg06ye.bkt.clouddn.com/image/lbs/user2.JPG)管理者 | 根据订单的位置特性，调度最合适的服务人员  | ![分析](http://p62mg06ye.bkt.clouddn.com/image/lbs/analysis.png)分析![数据](http://p62mg06ye.bkt.clouddn.com/image/lbs/data.png)数据![地图](http://p62mg06ye.bkt.clouddn.com/image/lbs/map.png)地图 |
| ![服务人员](http://p62mg06ye.bkt.clouddn.com/image/lbs/user3.JPG)服务人员 | 规划路线，前往上门服务地点         | ![轨迹](http://p62mg06ye.bkt.clouddn.com/image/lbs/trajectory.png)轨迹![前往](http://p62mg06ye.bkt.clouddn.com/image/lbs/travel.png)前往![地图](http://p62mg06ye.bkt.clouddn.com/image/lbs/map.png)地图 |

各个功能对应到地图开放平台的服务：

| 功能                                       | 端       | 服务             | 简介                                  | 相关链接                                     |
| ---------------------------------------- | ------- | -------------- | ----------------------------------- | ---------------------------------------- |
| ![定位](http://p62mg06ye.bkt.clouddn.com/image/lbs/location.png)定位 | App     | JavaScript API | 实现移动设备的定位功能（基于微信小程序）                | http://lbsyun.baidu.com/index.php?title=wxjsapi |
|                                          | Web App | 显示定位           | 显示微信小程序反馈的位置信息和目标用户（电梯）的位置信息        | http://lbsyun.baidu.com/index.php?title=webapi/ip-api |
| ![数据](http://p62mg06ye.bkt.clouddn.com/image/lbs/data.png)数据检索 | App     | 搜索设备信息         | 根据设备注册码或设备注册识别码检索服务信息               | 自开发                                      |
|                                          | Web App | 搜索服务人员的信息      | 根据用户提交的维保需求，给服务人员添加维保订单             | 自开发                                      |
| ![地图](http://p62mg06ye.bkt.clouddn.com/image/lbs/map.png)地图 | App     | JavaScript API | 服务人员和用户数据存入LBS云，使用麻点图功能实现大量量数据的地图展示 | http://lbsyun.baidu.com/jsdemo.htm#g0_4  |

##需求描述





##管理员

管理员可以对电梯维保人员的维护活动可以进行线上实时监控，线下数据绘表可视化管理。

###线上实时监控模块

- PC端对多用户活动进行实时监控

  >  当有多达几十个到一百个电梯维保人员时，微信小程序在性能上的缺陷无法提供对多个维保人员的维保活动进行监控，需要使用PC端高一些的性能进行管理。

  **功能** 维保人员记录数据可视化


  ![](http://p62mg06ye.bkt.clouddn.com//image/lbs/data2.jpeg)

这是以前一位朋友做的数据平台，数据可视化的图标方便管理者直观了解工作情况。

  所需技术

  - Echart.js结合百度地图开放服务

    制作做地图用户承载用户和服务人员的位置数据。


  - WebSocket

    在这个B/S结构的软件项目中，管理员和服务人员以及用户在使用客户端时需要实时的获得服务器消息，但默认HTTP协议只支持请求响应模式，这样做可以简化Web服务器，减少服务器的负担，加快响应速度，因为服务器不需要与客户端长时间建立一个通信链接，但不容易直接完成实时的消息推送功能，如后台信息提示、实时更新数据等功能，但通过HTML5中定义的WebSocket能完成该功能需要。


### Django驱动的内容管理系统

  **功能1**：提供数据库管理功能

  可以实现类似数据库客户端的功能，对数据进行增删改查

  **功能2**：二次开发

  基于该模块的数据管理功能，可以二次定制一些实用的功能。

  **功能3**：强大的文档和图片管理

  因为后台管理只面向少数用户，就用Django自带的数据管理功能，可以减少在这个地方花费时间。在此基础上二次定制一些管理人员实用的管理功能。

  ![](http://p62mg06ye.bkt.clouddn.com/image/lbs/Wagtial.png)

  这个内容管理系统我在做网站课设的时候使用过，感觉是一个美观，功能齐全的内容管理系统。

  虽然部署非常快，但我还没为这个软件做过二次开发，做定制加入地图插件的时候会有些麻烦。

  这样的话我想的方案是

  在独立的监控模块 外链加上sessionid（免用户认证）进入Wagtial进行管理。

  例如 在监控模块中点击用户选择操作（发送消息、添加服务订单。。etc），然后进入Wagtial的内容管理页面进行具体的操作。

  > 言外   如果想服务人员自动接收维保订单，需要记录维保人员的服务状态。然后将维保订单进行推送。

  ​

  ​

## 物业电梯维保检查人员



物业电梯维保检查人员对电梯维保情况进行记录 可以对管理者推送的维保服务订单进行维保计划，并记录下维保完成情况。



```python
###微信小程序提供定位服务

###**功能** 小程序记录订单目标用户的位置，并规划前往路线。

###![img](http://p62mg06ye.bkt.clouddn.com/image/lbs/1.png)
```



**功能2** 标记维保任务完成情况

![](http://p62mg06ye.bkt.clouddn.com/image/lbs/TaskList.png)

该图是一个多人协作软件的任务表页面 这里是一些效果图 实现思路和管理者的监控模块是一样的

![](http://p62mg06ye.bkt.clouddn.com/image/lbs/TaskList2.png)





-----



对物业电梯的维保检查记录人员权限管理

物业电梯权限为查询和标记完成 并备注完成时间



数据库 表结构如下

**物业注册用户表**

| 字段             | 类型      | 简介                         |
| -------------- | ------- | -------------------------- |
| 物业用户唯一id       | int     | 微信小程序提供的唯一id               |
| 物业用户所属单位       | varchar |                            |
| 物业用户个人信息etc。。。 |         |                            |
| 用户权限           | int     | ['0'："查询" ,'1'："查询，删除，添加"] |

**设备管理权限表**

| 字段         | 类型      | 简介   |
| ---------- | ------- | ---- |
| 用户id       | int     |      |
| 用户可管理设备识别码 | varchar |      |
|            |         |      |



**物业设备表**

| 字段          | 类型      | 简介     |
| ----------- | ------- | ------ |
| 物业唯一id      | int     | 物业对应id |
| 物业可管理设备注册代码 | varchar |        |
| 物业可管理的设备识别码 | varchar |        |


**设备维护记录**
| 字段           | 类型       | 简介             |
| ------------ | -------- | -------------- |
| 设备识别码        | varchar  |                |
| 设备维护时间       | DATETIME |                |
| 设备维护状况       | enum()   | 已按期维护，未维护，延时维护 |
| 设备维护登记者（物业方） | int      | 登记人员id         |
| 设备维护者（服务方）   | int      | 维护人员id         |

根据用户所属单位为用户显示电梯设备的维保信息

